(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}})();var L=Uint8Array,V=Uint16Array,Oe=Int32Array,xe=new L([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Se=new L([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Te=new L([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Je=function(t,e){for(var r=new V(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];for(var a=new Oe(r[30]),n=1;n<30;++n)for(var o=r[n];o<r[n+1];++o)a[o]=o-r[n]<<5|n;return{b:r,r:a}},Ve=Je(xe,2),Ke=Ve.b,Ae=Ve.r;Ke[28]=258,Ae[258]=28;var Ye=Je(Se,0),et=Ye.b,De=Ye.r,Fe=new V(32768);for(var T=0;T<32768;++T){var te=(T&43690)>>1|(T&21845)<<1;te=(te&52428)>>2|(te&13107)<<2,te=(te&61680)>>4|(te&3855)<<4,Fe[T]=((te&65280)>>8|(te&255)<<8)>>1}var Q=function(t,e,r){for(var n=t.length,a=0,o=new V(e);a<n;++a)t[a]&&++o[t[a]-1];var i=new V(e);for(a=1;a<e;++a)i[a]=i[a-1]+o[a-1]<<1;var s;if(r){s=new V(1<<e);var c=15-e;for(a=0;a<n;++a)if(t[a])for(var f=a<<4|t[a],l=e-t[a],u=i[t[a]-1]++<<l,d=u|(1<<l)-1;u<=d;++u)s[Fe[u]>>c]=f}else for(s=new V(n),a=0;a<n;++a)t[a]&&(s[a]=Fe[i[t[a]-1]++]>>15-t[a]);return s},re=new L(288);for(var T=0;T<144;++T)re[T]=8;for(var T=144;T<256;++T)re[T]=9;for(var T=256;T<280;++T)re[T]=7;for(var T=280;T<288;++T)re[T]=8;var we=new L(32);for(var T=0;T<32;++T)we[T]=5;var tt=Q(re,9,0),rt=Q(re,9,1),nt=Q(we,5,0),at=Q(we,5,1),ze=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},K=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(e&7)&r},Le=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(e&7)},Ue=function(t){return(t+7)/8|0},oe=function(t,e,r){return(e==null||e<0)&&(e=0),(r==null||r>t.length)&&(r=t.length),new L(t.subarray(e,r))},ot=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],z=function(t,e,r){var n=new Error(e||ot[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,z),!r)throw n;return n},it=function(t,e,r,n){var a=t.length,o=0;if(!a||e.f&&!e.l)return r||new L(0);var i=!r,s=i||e.i!=2,c=e.i;i&&(r=new L(a*3));var f=function(de){var ge=r.length;if(de>ge){var ce=new L(Math.max(ge*2,de));ce.set(r),r=ce}},l=e.f||0,u=e.p||0,d=e.b||0,B=e.l,w=e.d,b=e.m,v=e.n,p=a*8;do{if(!B){l=K(t,u,1);var y=K(t,u+1,3);if(u+=3,y)if(y==1)B=rt,w=at,b=9,v=5;else if(y==2){var E=K(t,u,31)+257,k=K(t,u+10,15)+4,g=E+K(t,u+5,31)+1;u+=14;for(var h=new L(g),I=new L(19),C=0;C<k;++C)I[Te[C]]=K(t,u+C*3,7);u+=k*3;for(var M=ze(I),O=(1<<M)-1,F=Q(I,M,1),C=0;C<g;){var D=F[K(t,u,O)];u+=D&15;var m=D>>4;if(m<16)h[C++]=m;else{var $=0,P=0;for(m==16?(P=3+K(t,u,3),u+=2,$=h[C-1]):m==17?(P=3+K(t,u,7),u+=3):m==18&&(P=11+K(t,u,127),u+=7);P--;)h[C++]=$}}var N=h.subarray(0,E),U=h.subarray(E);b=ze(N),v=ze(U),B=Q(N,b,1),w=Q(U,v,1)}else z(1);else{var m=Ue(u)+4,S=t[m-4]|t[m-3]<<8,x=m+S;if(x>a){c&&z(0);break}s&&f(d+S),r.set(t.subarray(m,x),d),e.b=d+=S,e.p=u=x*8,e.f=l;continue}if(u>p){c&&z(0);break}}s&&f(d+131072);for(var ae=(1<<b)-1,G=(1<<v)-1,X=u;;X=u){var $=B[Le(t,u)&ae],W=$>>4;if(u+=$&15,u>p){c&&z(0);break}if($||z(2),W<256)r[d++]=W;else if(W==256){X=u,B=null;break}else{var J=W-254;if(W>264){var C=W-257,A=xe[C];J=K(t,u,(1<<A)-1)+Ke[C],u+=A}var Y=w[Le(t,u)&G],se=Y>>4;Y||z(3),u+=Y&15;var U=et[se];if(se>3){var A=Se[se];U+=Le(t,u)&(1<<A)-1,u+=A}if(u>p){c&&z(0);break}s&&f(d+131072);var le=d+J;if(d<U){var ke=o-U,be=Math.min(U,le);for(ke+d<0&&z(3);d<be;++d)r[d]=n[ke+d]}for(;d<le;++d)r[d]=r[d-U]}}e.l=B,e.p=X,e.b=d,e.f=l,B&&(l=1,e.m=b,e.d=w,e.n=v)}while(!l);return d!=r.length&&i?oe(r,0,d):r.subarray(0,d)},_=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},pe=function(t,e,r){r<<=e&7;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},Me=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var a=r.length,o=r.slice();if(!a)return{t:fe,l:0};if(a==1){var i=new L(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(x,E){return x.f-E.f}),r.push({s:-1,f:25001});var s=r[0],c=r[1],f=0,l=1,u=2;for(r[0]={s:-1,f:s.f+c.f,l:s,r:c};l!=a-1;)s=r[r[f].f<r[u].f?f++:u++],c=r[f!=l&&r[f].f<r[u].f?f++:u++],r[l++]={s:-1,f:s.f+c.f,l:s,r:c};for(var d=o[0].s,n=1;n<a;++n)o[n].s>d&&(d=o[n].s);var B=new V(d+1),w=$e(r[l-1],B,0);if(w>e){var n=0,b=0,v=w-e,p=1<<v;for(o.sort(function(E,k){return B[k.s]-B[E.s]||E.f-k.f});n<a;++n){var y=o[n].s;if(B[y]>e)b+=p-(1<<w-B[y]),B[y]=e;else break}for(b>>=v;b>0;){var m=o[n].s;B[m]<e?b-=1<<e-B[m]++-1:++n}for(;n>=0&&b;--n){var S=o[n].s;B[S]==e&&(--B[S],++b)}w=e}return{t:new L(B),l:w}},$e=function(t,e,r){return t.s==-1?Math.max($e(t.l,e,r+1),$e(t.r,e,r+1)):e[t.s]=r},Ne=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new V(++e),n=0,a=t[0],o=1,i=function(c){r[n++]=c},s=1;s<=e;++s)if(t[s]==a&&s!=e)++o;else{if(!a&&o>2){for(;o>138;o-=138)i(32754);o>2&&(i(o>10?o-11<<5|28690:o-3<<5|12305),o=0)}else if(o>3){for(i(a),--o;o>6;o-=6)i(8304);o>2&&(i(o-3<<5|8208),o=0)}for(;o--;)i(a);o=1,a=t[s]}return{c:r.subarray(0,n),n:e}},me=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},Qe=function(t,e,r){var n=r.length,a=Ue(e+2);t[a]=n&255,t[a+1]=n>>8,t[a+2]=t[a]^255,t[a+3]=t[a+1]^255;for(var o=0;o<n;++o)t[a+o+4]=r[o];return(a+4+n)*8},qe=function(t,e,r,n,a,o,i,s,c,f,l){_(e,l++,r),++a[256];for(var u=Me(a,15),d=u.t,B=u.l,w=Me(o,15),b=w.t,v=w.l,p=Ne(d),y=p.c,m=p.n,S=Ne(b),x=S.c,E=S.n,k=new V(19),g=0;g<y.length;++g)++k[y[g]&31];for(var g=0;g<x.length;++g)++k[x[g]&31];for(var h=Me(k,7),I=h.t,C=h.l,M=19;M>4&&!I[Te[M-1]];--M);var O=f+5<<3,F=me(a,re)+me(o,we)+i,D=me(a,d)+me(o,b)+i+14+3*M+me(k,I)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&O<=F&&O<=D)return Qe(e,l,t.subarray(c,c+f));var $,P,N,U;if(_(e,l,1+(D<F)),l+=2,D<F){$=Q(d,B,0),P=d,N=Q(b,v,0),U=b;var ae=Q(I,C,0);_(e,l,m-257),_(e,l+5,E-1),_(e,l+10,M-4),l+=14;for(var g=0;g<M;++g)_(e,l+3*g,I[Te[g]]);l+=3*M;for(var G=[y,x],X=0;X<2;++X)for(var W=G[X],g=0;g<W.length;++g){var J=W[g]&31;_(e,l,ae[J]),l+=I[J],J>15&&(_(e,l,W[g]>>5&127),l+=W[g]>>12)}}else $=tt,P=re,N=nt,U=we;for(var g=0;g<s;++g){var A=n[g];if(A>255){var J=A>>18&31;pe(e,l,$[J+257]),l+=P[J+257],J>7&&(_(e,l,A>>23&31),l+=xe[J]);var Y=A&31;pe(e,l,N[Y]),l+=U[Y],Y>3&&(pe(e,l,A>>5&8191),l+=Se[Y])}else pe(e,l,$[A]),l+=P[A]}return pe(e,l,$[256]),l+P[256]},st=new Oe([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),fe=new L(0),lt=function(t,e,r,n,a,o){var i=o.z||t.length,s=new L(n+i+5*(1+Math.ceil(i/7e3))+a),c=s.subarray(n,s.length-a),f=o.l,l=(o.r||0)&7;if(e){l&&(c[0]=o.r>>3);for(var u=st[e-1],d=u>>13,B=u&8191,w=(1<<r)-1,b=o.p||new V(32768),v=o.h||new V(w+1),p=Math.ceil(r/3),y=2*p,m=function(Ce){return(t[Ce]^t[Ce+1]<<p^t[Ce+2]<<y)&w},S=new Oe(25e3),x=new V(288),E=new V(32),k=0,g=0,h=o.i||0,I=0,C=o.w||0,M=0;h+2<i;++h){var O=m(h),F=h&32767,D=v[O];if(b[F]=D,v[O]=F,C<=h){var $=i-h;if((k>7e3||I>24576)&&($>423||!f)){l=qe(t,c,0,S,x,E,g,I,M,h-M,l),I=k=g=0,M=h;for(var P=0;P<286;++P)x[P]=0;for(var P=0;P<30;++P)E[P]=0}var N=2,U=0,ae=B,G=F-D&32767;if($>2&&O==m(h-G))for(var X=Math.min(d,$)-1,W=Math.min(32767,h),J=Math.min(258,$);G<=W&&--ae&&F!=D;){if(t[h+N]==t[h+N-G]){for(var A=0;A<J&&t[h+A]==t[h+A-G];++A);if(A>N){if(N=A,U=G,A>X)break;for(var Y=Math.min(G,A-2),se=0,P=0;P<Y;++P){var le=h-G+P&32767,ke=b[le],be=le-ke&32767;be>se&&(se=be,D=le)}}}F=D,D=b[F],G+=F-D&32767}if(U){S[I++]=268435456|Ae[N]<<18|De[U];var de=Ae[N]&31,ge=De[U]&31;g+=xe[de]+Se[ge],++x[257+de],++E[ge],C=h+N,++k}else S[I++]=t[h],++x[t[h]]}}for(h=Math.max(h,C);h<i;++h)S[I++]=t[h],++x[t[h]];l=qe(t,c,f,S,x,E,g,I,M,h-M,l),f||(o.r=l&7|c[l/8|0]<<3,l-=7,o.h=v,o.p=b,o.i=h,o.w=C)}else{for(var h=o.w||0;h<i+f;h+=65535){var ce=h+65535;ce>=i&&(c[l/8|0]=f,ce=i),l=Qe(c,l+1,t.subarray(h,ce))}o.i=i}return oe(s,0,n+Ue(l)+a)},ct=function(){for(var t=new Int32Array(256),e=0;e<256;++e){for(var r=e,n=9;--n;)r=(r&1&&-306674912)^r>>>1;t[e]=r}return t}(),ft=function(){var t=-1;return{p:function(e){for(var r=t,n=0;n<e.length;++n)r=ct[r&255^e[n]]^r>>>8;t=r},d:function(){return~t}}},ut=function(t,e,r,n,a){if(!a&&(a={l:1},e.dictionary)){var o=e.dictionary.subarray(-32768),i=new L(o.length+t.length);i.set(o),i.set(t,o.length),t=i,a.w=o.length}return lt(t,e.level==null?6:e.level,e.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(t.length)))*1.5):20:12+e.mem,r,n,a)},ht=function(t,e){var r={};for(var n in t)r[n]=t[n];for(var n in e)r[n]=e[n];return r},ue=function(t,e){return t[e]|t[e+1]<<8},he=function(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0},Pe=function(t,e){return he(t,e)+he(t,e+4)*4294967296},j=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},vt=function(){function t(e,r){if(typeof e=="function"&&(r=e,e={}),this.ondata=r,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new L(98304),this.o.dictionary){var n=this.o.dictionary.subarray(-32768);this.b.set(n,32768-n.length),this.s.i=32768-n.length}}return t.prototype.p=function(e,r){this.ondata(ut(e,this.o,0,0,this.s),r)},t.prototype.push=function(e,r){this.ondata||z(5),this.s.l&&z(4);var n=e.length+this.s.z;if(n>this.b.length){if(n>2*this.b.length-32768){var a=new L(n&-32768);a.set(this.b.subarray(0,this.s.z)),this.b=a}var o=this.b.length-this.s.z;this.b.set(e.subarray(0,o),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(o),32768),this.s.z=e.length-o+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=r&1,(this.s.z>this.s.w+8191||r)&&(this.p(this.b,r||!1),this.s.w=this.s.i,this.s.i-=2)},t.prototype.flush=function(){this.ondata||z(5),this.s.l&&z(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},t}(),dt=function(){function t(e,r){typeof e=="function"&&(r=e,e={}),this.ondata=r;var n=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:n?n.length:0},this.o=new L(32768),this.p=new L(0),n&&this.o.set(n)}return t.prototype.e=function(e){if(this.ondata||z(5),this.d&&z(4),!this.p.length)this.p=e;else if(e.length){var r=new L(this.p.length+e.length);r.set(this.p),r.set(e,this.p.length),this.p=r}},t.prototype.c=function(e){this.s.i=+(this.d=e||!1);var r=this.s.b,n=it(this.p,this.s,this.o);this.ondata(oe(n,r,this.s.b),this.d),this.o=oe(n,this.s.b-32768),this.s.b=this.o.length,this.p=oe(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(e,r){this.e(e),this.c(r)},t}(),Re=typeof TextEncoder<"u"&&new TextEncoder,je=typeof TextDecoder<"u"&&new TextDecoder,gt=0;try{je.decode(fe,{stream:!0}),gt=1}catch{}var pt=function(t){for(var e="",r=0;;){var n=t[r++],a=(n>127)+(n>223)+(n>239);if(r+a>t.length)return{s:e,r:oe(t,r-1)};a?a==3?(n=((n&15)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,e+=String.fromCharCode(55296|n>>10,56320|n&1023)):a&1?e+=String.fromCharCode((n&31)<<6|t[r++]&63):e+=String.fromCharCode((n&15)<<12|(t[r++]&63)<<6|t[r++]&63):e+=String.fromCharCode(n)}};function Ge(t,e){var r;if(Re)return Re.encode(t);for(var n=t.length,a=new L(t.length+(t.length>>1)),o=0,i=function(f){a[o++]=f},r=0;r<n;++r){if(o+5>a.length){var s=new L(o+8+(n-r<<1));s.set(a),a=s}var c=t.charCodeAt(r);c<128||e?i(c):c<2048?(i(192|c>>6),i(128|c&63)):c>55295&&c<57344?(c=65536+(c&1047552)|t.charCodeAt(++r)&1023,i(240|c>>18),i(128|c>>12&63),i(128|c>>6&63),i(128|c&63)):(i(224|c>>12),i(128|c>>6&63),i(128|c&63))}return oe(a,0,o)}function mt(t,e){if(e){for(var r="",n=0;n<t.length;n+=16384)r+=String.fromCharCode.apply(null,t.subarray(n,n+16384));return r}else{if(je)return je.decode(t);var a=pt(t),o=a.s,r=a.r;return r.length&&z(8),o}}var wt=function(t){return t==1?3:t<6?2:t==9?1:0},yt=function(t,e){for(;ue(t,e)!=1;e+=4+ue(t,e+2));return[Pe(t,e+12),Pe(t,e+4),Pe(t,e+20)]},Be=function(t){var e=0;if(t)for(var r in t){var n=t[r].length;n>65535&&z(9),e+=n+4}return e},He=function(t,e,r,n,a,o,i,s){var c=n.length,f=r.extra,l=s&&s.length,u=Be(f);j(t,e,i!=null?33639248:67324752),e+=4,i!=null&&(t[e++]=20,t[e++]=r.os),t[e]=20,e+=2,t[e++]=r.flag<<1|(o<0&&8),t[e++]=a&&8,t[e++]=r.compression&255,t[e++]=r.compression>>8;var d=new Date(r.mtime==null?Date.now():r.mtime),B=d.getFullYear()-1980;if((B<0||B>119)&&z(10),j(t,e,B<<25|d.getMonth()+1<<21|d.getDate()<<16|d.getHours()<<11|d.getMinutes()<<5|d.getSeconds()>>1),e+=4,o!=-1&&(j(t,e,r.crc),j(t,e+4,o<0?-o-2:o),j(t,e+8,r.size)),j(t,e+12,c),j(t,e+14,u),e+=16,i!=null&&(j(t,e,l),j(t,e+6,r.attrs),j(t,e+10,i),e+=14),t.set(n,e),e+=c,u)for(var w in f){var b=f[w],v=b.length;j(t,e,+w),j(t,e+2,v),t.set(b,e+4),e+=4+v}return l&&(t.set(s,e),e+=l),e},kt=function(t,e,r,n,a){j(t,e,101010256),j(t,e+8,r),j(t,e+10,r),j(t,e+12,n),j(t,e+16,a)},Ze=function(){function t(e){this.filename=e,this.c=ft(),this.size=0,this.compression=0}return t.prototype.process=function(e,r){this.ondata(null,e,r)},t.prototype.push=function(e,r){this.ondata||z(5),this.c.p(e),this.size+=e.length,r&&(this.crc=this.c.d()),this.process(e,r||!1)},t}(),We=function(){function t(e,r){var n=this;r||(r={}),Ze.call(this,e),this.d=new vt(r,function(a,o){n.ondata(null,a,o)}),this.compression=8,this.flag=wt(r.level)}return t.prototype.process=function(e,r){try{this.d.push(e,r)}catch(n){this.ondata(n,null,r)}},t.prototype.push=function(e,r){Ze.prototype.push.call(this,e,r)},t}(),bt=function(){function t(e){this.ondata=e,this.u=[],this.d=1}return t.prototype.add=function(e){var r=this;if(this.ondata||z(5),this.d&2)this.ondata(z(4+(this.d&1)*8,0,1),null,!1);else{var n=Ge(e.filename),a=n.length,o=e.comment,i=o&&Ge(o),s=a!=e.filename.length||i&&o.length!=i.length,c=a+Be(e.extra)+30;a>65535&&this.ondata(z(11,0,1),null,!1);var f=new L(c);He(f,0,e,n,s,-1);var l=[f],u=function(){for(var v=0,p=l;v<p.length;v++){var y=p[v];r.ondata(null,y,!1)}l=[]},d=this.d;this.d=0;var B=this.u.length,w=ht(e,{f:n,u:s,o:i,t:function(){e.terminate&&e.terminate()},r:function(){if(u(),d){var v=r.u[B+1];v?v.r():r.d=1}d=1}}),b=0;e.ondata=function(v,p,y){if(v)r.ondata(v,p,y),r.terminate();else if(b+=p.length,l.push(p),y){var m=new L(16);j(m,0,134695760),j(m,4,e.crc),j(m,8,b),j(m,12,e.size),l.push(m),w.c=b,w.b=c+b+16,w.crc=e.crc,w.size=e.size,d&&w.r(),d=1}else d&&u()},this.u.push(w)}},t.prototype.end=function(){var e=this;if(this.d&2){this.ondata(z(4+(this.d&1)*8,0,1),null,!0);return}this.d?this.e():this.u.push({r:function(){e.d&1&&(e.u.splice(-1,1),e.e())},t:function(){}}),this.d=3},t.prototype.e=function(){for(var e=0,r=0,n=0,a=0,o=this.u;a<o.length;a++){var i=o[a];n+=46+i.f.length+Be(i.extra)+(i.o?i.o.length:0)}for(var s=new L(n+22),c=0,f=this.u;c<f.length;c++){var i=f[c];He(s,e,i,i.f,i.u,-i.c-2,r,i.o),e+=46+i.f.length+Be(i.extra)+(i.o?i.o.length:0),r+=i.b}kt(s,e,this.u.length,n,r),this.ondata(null,s,!0),this.d=2},t.prototype.terminate=function(){for(var e=0,r=this.u;e<r.length;e++){var n=r[e];n.t()}this.d=2},t}(),Bt=function(){function t(){}return t.prototype.push=function(e,r){this.ondata(null,e,r)},t.compression=0,t}(),xt=function(){function t(){var e=this;this.i=new dt(function(r,n){e.ondata(null,r,n)})}return t.prototype.push=function(e,r){try{this.i.push(e,r)}catch(n){this.ondata(n,null,r)}},t.compression=8,t}(),St=function(){function t(e){this.onfile=e,this.k=[],this.o={0:Bt},this.p=fe}return t.prototype.push=function(e,r){var n=this;if(this.onfile||z(5),this.p||z(4),this.c>0){var a=Math.min(this.c,e.length),o=e.subarray(0,a);if(this.c-=a,this.d?this.d.push(o,!this.c):this.k[0].push(o),e=e.subarray(a),e.length)return this.push(e,r)}else{var i=0,s=0,c=void 0,f=void 0;this.p.length?e.length?(f=new L(this.p.length+e.length),f.set(this.p),f.set(e,this.p.length)):f=this.p:f=e;for(var l=f.length,u=this.c,d=u&&this.d,B=function(){var p,y=he(f,s);if(y==67324752){i=1,c=s,w.d=null,w.c=0;var m=ue(f,s+6),S=ue(f,s+8),x=m&2048,E=m&8,k=ue(f,s+26),g=ue(f,s+28);if(l>s+30+k+g){var h=[];w.k.unshift(h),i=2;var I=he(f,s+18),C=he(f,s+22),M=mt(f.subarray(s+30,s+=30+k),!x);I==4294967295?(p=E?[-2]:yt(f,s),I=p[0],C=p[1]):E&&(I=-1),s+=g,w.c=I;var O,F={name:M,compression:S,start:function(){if(F.ondata||z(5),!I)F.ondata(null,fe,!0);else{var D=n.o[S];D||F.ondata(z(14,"unknown compression type "+S,1),null,!1),O=I<0?new D(M):new D(M,I,C),O.ondata=function(U,ae,G){F.ondata(U,ae,G)};for(var $=0,P=h;$<P.length;$++){var N=P[$];O.push(N,!1)}n.k[0]==h&&n.c?n.d=O:O.push(fe,!0)}},terminate:function(){O&&O.terminate&&O.terminate()}};I>=0&&(F.size=I,F.originalSize=C),w.onfile(F)}return"break"}else if(u){if(y==134695760)return c=s+=12+(u==-2&&8),i=3,w.c=0,"break";if(y==33639248)return c=s-=4,i=3,w.c=0,"break"}},w=this;s<l-4;++s){var b=B();if(b==="break")break}if(this.p=fe,u<0){var v=i?f.subarray(0,c-12-(u==-2&&8)-(he(f,c-16)==134695760&&4)):f.subarray(0,s);d?d.push(v,!!i):this.k[+(i==2)].push(v)}if(i&2)return this.push(f.subarray(s),r);this.p=f.subarray(s)}r&&(this.c&&z(13),this.p=null)},t.prototype.register=function(e){this.o[e.compression]=e},t}();const Et="LibraryDB",q="books",Z="booklist",It=2;let ee=null,ne=[],ie=[],H=1;const ve=10;let R=new Set;function Ct(){return new Promise((t,e)=>{const r=indexedDB.open(Et,It);r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(q)||a.createObjectStore(q,{keyPath:"bookId"}),a.objectStoreNames.contains(Z)||a.createObjectStore(Z,{keyPath:"bookId"})},r.onsuccess=n=>t(n.target.result),r.onerror=n=>e(n.target.error)})}async function zt(){try{ee=await Ct();const r=ee.transaction([Z],"readonly").objectStore(Z).getAll();r.onsuccess=()=>{ne=r.result||[],ne.reverse(),Ee()},r.onerror=n=>console.error("Error loading books:",n)}catch(t){console.error("Failed to open DB:",t)}}function Ee(){const t=document.getElementById("searchInput").value.toLowerCase();t?ie=ne.filter(e=>{const r=(e.title||"").toLowerCase(),n=(e.author||"").toLowerCase();return r.includes(t)||n.includes(t)}):ie=ne,H=1,ye()}function ye(){const t=document.getElementById("bookGrid"),e=document.getElementById("emptyState"),r=document.getElementById("pageInfo"),n=document.getElementById("prevBtn"),a=document.getElementById("nextBtn");if(t.innerHTML="",ie.length===0){e.style.display="block",t.style.display="none",r.textContent="0 / 0",n.disabled=!0,a.disabled=!0;return}e.style.display="none",t.style.display="grid";const o=Math.ceil(ie.length/ve);H>o&&(H=o),H<1&&(H=1);const i=(H-1)*ve,s=i+ve;ie.slice(i,s).forEach(f=>{const l=Lt(f);t.appendChild(l)}),r.textContent=`${H} / ${o}`,n.disabled=H===1,a.disabled=H===o}function Lt(t){const e=document.createElement("div");e.className="book-card";const r=t.cover||"icons/icon128.png",n=R.has(t.bookId)?"checked":"";e.innerHTML=`
        <div class="book-checkbox-wrapper ${n?"checked":""}">
            <input type="checkbox" class="book-checkbox" ${n}>
        </div>
        <div class="cover-wrapper">
            <img src="${r}" alt="${t.title}" onerror="this.src='icons/icon128.png'">
        </div>
        <div class="book-info">
            <div class="book-title" title="${t.title}">${t.title||"Tanpa Judul"}</div>
            <div class="book-author" title="${t.author}">${t.author||"Tanpa Pengarang"}</div>
            <div class="actions">
                <button class="download-btn" title="Unduh File">
                    Unduh Buku
                </button>
                <button class="delete-btn" title="Hapus Buku">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                        <line x1="10" y1="11" x2="10" y2="17"></line>
                        <line x1="14" y1="11" x2="14" y2="17"></line>
                    </svg>
                </button>
            </div>
        </div>
    `;const a=e.querySelector(".download-btn");a.onclick=()=>Mt(t);const o=e.querySelector(".delete-btn");o.onclick=()=>Pt(t);const i=e.querySelector(".book-checkbox"),s=e.querySelector(".book-checkbox-wrapper");return i.onchange=c=>{c.target.checked?(R.add(t.bookId),s.classList.add("checked")):(R.delete(t.bookId),s.classList.remove("checked")),Ie()},e}async function Mt(t){try{const n=ee.transaction([q],"readonly").objectStore(q).get(t.bookId);n.onsuccess=()=>{const a=n.result;if(a&&a.file){const o=a.file,i=a.ext||"pdf",c=`${(t.title||"book").replace(/[/\\?%*:|"<>]/g,"-")}.${i}`,f=URL.createObjectURL(o);chrome.downloads.download({url:f,filename:c,saveAs:!0},l=>{setTimeout(()=>URL.revokeObjectURL(f),1e3),chrome.runtime.lastError&&(console.error(chrome.runtime.lastError),alert("Gagal memulai download: "+chrome.runtime.lastError.message))})}else alert("File tidak ditemukan di database. Silakan unduh ulang dari website.")},n.onerror=()=>alert("Gagal mengambil file dari database.")}catch(e){console.error("Download error:",e)}}async function Pt(t){if(confirm(`Apakah Anda yakin ingin menghapus buku "${t.title}"?`))try{const e=ee.transaction([q,Z],"readwrite"),r=e.objectStore(q),n=e.objectStore(Z);r.delete(t.bookId),n.delete(t.bookId),e.oncomplete=()=>{ne=ne.filter(a=>a.bookId!==t.bookId),Ee()},e.onerror=a=>{console.error("Delete failed:",a),alert("Gagal menghapus buku: "+a.target.error)}}catch(e){console.error("Delete error:",e)}}function Ie(){const t=document.getElementById("bulkActionBar"),e=document.getElementById("selectedCount");e.textContent=R.size,R.size>0?t.classList.add("visible"):t.classList.remove("visible")}function Tt(){R.clear(),ye(),Ie()}function At(){const t=(H-1)*ve,e=t+ve,r=ie.slice(t,e);let n=!0;for(const a of r)if(!R.has(a.bookId)){n=!1;break}n?r.forEach(a=>R.delete(a.bookId)):r.forEach(a=>R.add(a.bookId)),ye(),Ie()}async function Ft(){if(R.size!==0&&confirm(`Hapus ${R.size} buku yang dipilih?`))try{const t=ee.transaction([q,Z],"readwrite"),e=t.objectStore(q),r=t.objectStore(Z);let n=0;for(const a of R)e.delete(a),r.delete(a),n++;t.oncomplete=()=>{ne=ne.filter(a=>!R.has(a.bookId)),R.clear(),Ee(),Ie()},t.onerror=a=>{console.error("Bulk delete failed:",a),alert("Gagal menghapus beberapa buku.")}}catch(t){console.error("Bulk delete error:",t)}}async function Xe(t,e,r,n){let a;const o=document.getElementById(n),i=o.textContent,s=new Date().toISOString().slice(0,10),c=`${e}_${s}${r}`;try{a=await window.showSaveFilePicker({suggestedName:c,types:[{description:r===".backup"?"Library Backup":"Shared Books",accept:{"application/zip":[r]}}]});const f=await a.createWritable(),l=new bt((k,g,h)=>{if(k)throw k;g.length>0&&f.write(g),h&&f.close()}),u=ee.transaction([q,Z],"readonly"),d=u.objectStore(q),B=u.objectStore(Z);let w=await new Promise((k,g)=>{const h=B.getAll();h.onsuccess=()=>k(h.result),h.onerror=()=>g(h.error)});t&&(w=w.filter(k=>t.has(k.bookId)));const b=[],v=[];let p=d.openCursor();await new Promise((k,g)=>{p.onsuccess=h=>{const I=h.target.result;if(I){const C=I.value;if(!t||t.has(C.bookId)){const{file:M,...O}=C;b.push(O),M&&v.push({id:C.bookId,file:M,ext:C.ext||"pdf"})}I.continue()}else k()},p.onerror=()=>g(p.error)}),v.length===0&&(!t||t.size>0);const y={version:2,timestamp:new Date().toISOString(),type:t?"partial":"full",booklist:w,books:b},m=JSON.stringify(y,null,2),S=new We("metadata.json",{level:9});l.add(S),S.push(new TextEncoder().encode(m),!0);let x=0;const E=v.length;for(const k of v){x++,o.textContent=`Proses... ${x}/${E}`;const g=`files/${k.id}.${k.ext}`,h=new We(g,{level:0});l.add(h);const I=k.file.stream().getReader();for(;;){const{done:C,value:M}=await I.read();if(C)break;h.push(M,!1)}h.push(new Uint8Array(0),!0)}l.end(),o.textContent=i,alert("Proses selesai! File telah tersimpan.")}catch(f){console.error("Export failed:",f),f.name!=="AbortError"&&alert("Gagal: "+f.message),o.textContent=i}}function $t(t){const e=t.reduce((a,o)=>a+o.length,0),r=new Uint8Array(e);let n=0;for(const a of t)r.set(a,n),n+=a.length;return r}document.addEventListener("DOMContentLoaded",()=>{zt(),document.getElementById("searchInput").addEventListener("input",Ee),document.getElementById("prevBtn").addEventListener("click",()=>{H>1&&(H--,ye())}),document.getElementById("nextBtn").addEventListener("click",()=>{const n=Math.ceil(ie.length/ve);H<n&&(H++,ye())}),document.getElementById("selectAllBtn").addEventListener("click",At),document.getElementById("deleteSelectedBtn").addEventListener("click",Ft),document.getElementById("cancelSelectionBtn").addEventListener("click",Tt),document.getElementById("sendSelectedBtn").addEventListener("click",Ot),document.getElementById("backupBtn").addEventListener("click",jt);const e=document.getElementById("restoreInput");document.getElementById("restoreBtn").addEventListener("click",()=>e.click()),e.addEventListener("change",n=>{n.target.files.length>0&&(Ut(n.target.files[0]),n.target.value="")});const r=document.getElementById("receiveInput");document.getElementById("receiveBtn").addEventListener("click",()=>r.click()),r.addEventListener("change",n=>{n.target.files.length>0&&(Dt(n.target.files[0]),n.target.value="")})});async function jt(){await Xe(null,"backup_library",".backup","backupBtn")}async function _e(t,e,r){if(e==="overwrite"&&!confirm("PERINGATAN: Restore akan MENGHAPUS SEMUA DATA yang ada saat ini. Lanjutkan?"))return;const n=document.getElementById(r),a=n.textContent;n.textContent="Processing...",n.disabled=!0;try{let u=function(){l>0?n.textContent=`Proses... ${f}/${l}`:f>0&&(n.textContent=`Proses... ${f}`)},w=function(v,p){return new Promise((y,m)=>{const S=ee.transaction([q],"readwrite"),x=S.objectStore(q),E=x.get(v);E.onsuccess=()=>{const k=E.result||{bookId:v},g=p(k);x.put(g)},S.oncomplete=y,S.onerror=k=>{console.error("Merge error",k),y()}})};var o=u,i=w;if(e==="overwrite"){const v=ee.transaction([q,Z],"readwrite");await Promise.all([new Promise((p,y)=>{const m=v.objectStore(q).clear();m.onsuccess=p,m.onerror=y}),new Promise((p,y)=>{const m=v.objectStore(Z).clear();m.onsuccess=p,m.onerror=y})])}const s=new St;s.register(xt);let c=[],f=0,l=0;s.onfile=v=>{if(v.name==="metadata.json"){const p=[];v.ondata=(y,m,S)=>{if(y)throw y;if(p.push(m),S){const x=new TextDecoder().decode($t(p));try{const E=JSON.parse(x);E.books&&(l=E.books.length,u()),c.push(d(E,e))}catch(E){console.error("Metadata parse error",E)}}}}else if(v.name.startsWith("files/")){const p=v.name.split("/").pop(),y=p.split(".")[0],m=p.split(".").pop(),S=[];v.ondata=(x,E,k)=>{if(x)throw x;if(S.push(E),k){const g=m==="epub"?"application/epub+zip":"application/pdf",h=new Blob(S,{type:g});c.push(B(y,h,m).then(()=>{f++,u()}))}}}v.start()};async function d(v,p){const y=ee.transaction([q,Z],"readwrite"),m=y.objectStore(q),S=y.objectStore(Z);if(v.booklist)for(const x of v.booklist)S.put(x);if(v.books)for(const x of v.books)await w(x.bookId,E=>({...E,...x}))}async function B(v,p,y){await w(v,m=>({...m,bookId:v,file:p,ext:y}))}const b=t.stream().getReader();for(;;){const{done:v,value:p}=await b.read();if(v){s.push(new Uint8Array(0),!0);break}s.push(p),c.length>50&&(await Promise.all(c),c=[])}c.length>0&&await Promise.all(c),alert(e==="overwrite"?"Restore berhasil! Library akan dimuat ulang.":"Buku berhasil diterima/digabungkan!"),location.reload()}catch(s){console.error("Import failed:",s),alert("Gagal: "+s.message),n.textContent=a,n.disabled=!1}}async function Ot(){if(R.size===0){alert("Pilih minimal satu buku untuk dikirim.");return}await Xe(R,"send_books",".send","sendSelectedBtn")}async function Ut(t){if(!t.name.endsWith(".backup")){alert("File tidak valid! Restore hanya menerima file berakhiran .backup");return}await _e(t,"overwrite","restoreBtn")}async function Dt(t){if(!t.name.endsWith(".send")){alert("File tidak valid! Terima Buku hanya menerima file berakhiran .send");return}await _e(t,"merge","receiveBtn")}
